{% load static %}
<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PanierFacile</title>

    <meta name="description" content="G√©rez vos listes de courses facilement avec PanierFacile">

    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXX"
         crossorigin="anonymous"></script>

    <!-- Styles CSS -->
    <link rel="stylesheet" href="{% static 'css/styles.css' %}" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
  </head>
  <body>
    <!--Navbar -->
    <nav class="navbar navbar-dark bg-dark shadow px-4">
      <div
        class="container-fluid d-flex justify-content-between align-items-center"
      >
        <!-- Logo PanierFacile -->
        <a
          class="navbar-brand d-flex align-items-center"
          href="{% url 'home' %}"
        >
          <i class="fas fa-shopping-cart fa-lg me-2"></i>
          <span>PanierFacile</span>
        </a>

        <!-- Liens de navigation -->
        <ul class="nav">
          <li class="nav-item">
            <a class="nav-link text-white" href="{% url 'home' %}">Accueil</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-white" href="{% url 'liste_paniers' %}"
              >Panier</a
            >
          </li>
          <li class="nav-item">
            <a class="nav-link text-white" href="{% url 'contact' %}"
              ><i class="fas fa-envelope me-1"></i>Contact</a
            >
          </li>
          {% comment %}
          <li class="nav-item">
            <a class="nav-link text-white" href="{% url 'panier' %}">Panier</a>
          </li>
          {% endcomment %} {% comment %}
          <li class="nav-item">
            <a class="nav-link text-white" href="{% url 'dashboard' %}"
              >Dashboard</a
            >
          </li>
          {% endcomment %}
        </ul>

        <div>
          {% if user.is_authenticated %}
          <li class="nav-item d-flex align-items-center">
            <!-- Bouton d'abonnement Stripe -->
            <button id="checkout-navbar" class="btn btn-warning btn-sm me-2"
                    data-checkout-url="{% url 'create_checkout_session' %}">
              S'abonner
            </button>

            <!-- Nom de l'utilisateur avec lien vers profil -->
            <a href="{% url 'profile' %}" class="navbar-text me-3 text-decoration-none">
              <i class="fas fa-user text-primary"></i>
              <strong class="text-white">{{ request.user.username }}</strong>
            </a>

             {% comment %} {% include "panier/chatbot.html" %} {% endcomment %}

            <!-- Bouton D√©connexion -->
            <form method="post" action="{% url 'logout' %}" class="d-inline">
              {% csrf_token %}
              <button type="submit" class="btn btn-danger">
                <i class="fas fa-sign-out-alt"></i> D√©connexion
              </button>
            </form>
          </li>
          {% else %}
          <li class="nav-item">
            <a href="{% url 'login' %}" class="btn btn-primary">
              <i class="fas fa-sign-in-alt"></i> Connexion
            </a>
          </li>
          {% endif %}
        </div>

        <!-- Recherche (non fonctionnelle pour le moment) -->
        <!--Je commente pour le moment car pas besoin-->
        {% comment %} <div class="d-flex align-items-center">
          <input
            class="form-control me-3"
            type="search"
            placeholder="Rechercher..."
            aria-label="Rechercher"
          />
        </div> {% endcomment %}
      </div>
    </nav>

    <!--Contenu Principal -->
    <div class="d-flex flex-column justify-content-center align-items-center text-center main-content">
      {% block content %} {% endblock content %}
    </div>

    <!-- Scripts Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://js.stripe.com/v3/"></script>

    <!-- Configuration pour JavaScript (variables Django) -->
    <div id="stripe-key" data-key="{{ STRIPE_PUBLISHABLE_KEY }}"></div>
    <div id="chatbot-config" data-url="{% url 'chatbot_ui' %}"></div>

    <!-- Bouton flottant chatbot -->
    <button id="openChatBtn" class="chat-toggle-btn">üí¨</button>

    <!-- Fen√™tre chatbot -->
    <div class="chatbot-container" id="chatbot">
        <div class="chat-header">
            <h4>ü§ñ Assistant Panier Facile</h4>
            <button id="closeChatBtn" class="close-btn">‚úñ</button>
        </div>

        <div class="chat-box" id="chatBox">
            <div class="message bot">
                Bonjour ! Je suis votre assistant virtuel. Posez-moi vos questions.
            </div>
            <div class="suggestions">
                <button class="suggestion-btn" data-question="Comment voir la liste des paniers ?">üìã Voir mes paniers</button>
                <button class="suggestion-btn" data-question="Comment voir la liste des courses ?">üõí Voir mes courses</button>
                <button class="suggestion-btn" data-question="Comment ajouter une course ?">‚ûï Ajouter une course</button>
            </div>
            <div class="loading" id="loading"><span>‚è≥ Recherche en cours...</span></div>
        </div>

        <div class="input-container">
            <input type="text" id="questionInput" class="chat-input" placeholder="Tapez votre question...">
            <button class="send-btn" id="sendBtn">Envoyer</button>
        </div>
    </div>

    <!-- Scripts JavaScript externes -->
    <script src="{% static 'js/base.js' %}"></script>
    <script src="{% static 'js/chatbot.js' %}"></script>
<footer class="footer bg-dark text-light text-center py-3 mt-4">
    <p class="mb-1">¬© 2025 PanierFacile</p>
    <p class="mb-0">
        <a href="{% url 'mentions_legales' %}" class="text-light text-decoration-none">Mentions l√©gales</a> |
        <a href="{% url 'rgpd' %}" class="text-light text-decoration-none">Politique de confidentialit√©</a> |
        <a href="{% url 'cgu' %}" class="text-light text-decoration-none">CGU</a>
    </p>
</footer>



  </body>
</html>
